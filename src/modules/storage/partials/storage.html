<tr class="pool" data-id="<%=pool.poolGuid%>">
	<td class="d-none d-md-table-cell p-0">
		<div class="card-image px-2">
			<%if (pool.name === 'system') {%>
				<i class="icon-light icon-sd-card"></i>
			<%} else {%>
				<i class="icon-light icon-database"></i>
			<%}%>
		</div>
	</td>
	<td style="min-width: 210px; max-width: 0;">
		<div class="d-flex align-items-center mb-n1">
			<div class="text-truncate">
				<%if (pool.name === 'system') {%>
					VirgoOS
				<%} else {%>
					<%=pool.name%>
				<%}%>
			</div>
			<%const rootVdev = pool.vdevs?.[pool.name]%>
			<%const childVdevs = (rootVdev?.vdevs ? Object.values(rootVdev.vdevs) : [])%>
			<%const poolConfig = (childVdevs.length > 0 ? childVdevs[0].vdevType : null)%>
			<%if (poolConfig && poolConfig !== 'disk') {%>
				<u-badge class="ms-2" pill><small><%=poolConfig%></small></u-badge>
			<%}%>
		</div>
		<div class="d-flex">
			<div class="text-truncate"><small class="text-body-tertiary"><%=(pool.name === 'system' ? 'system' : 'data')%></small></div>
		</div>
	</td>
	<td class="text-end text-nowrap d-none d-md-table-cell">
		<small class="fw-light"><%=prettyBytes(pool.properties.size.value || 0, { binary: true })%></small>
	</td>
	<td class="text-end text-nowrap d-none d-md-table-cell">
		<%const progressColorData = (pool.properties.capacity.value >= 80 ? (pool.properties.capacity.value >= 90 ? 'bg-red-300' : 'bg-orange-300') : 'bg-blue-300')%>
		<small class="fw-light" data-bs-toggle="tooltip" data-bs-original-title="<%=prettyBytes(pool.properties.allocated.value || 0, { binary: true })%>"><%=pool.properties.capacity.value.toFixed(2)%>%</small>
		<div class="progress shadow-none" role="progressbar" style="height: 6px;">
			<div class="progress-bar <%=progressColorData%>" style="width: <%=pool.properties.capacity.value%>%;"></div>
		</div>
	</td>
	<td class="<%=(pool.type?.toLowerCase() === 'pool' && pool.scanStats?.state.toLowerCase() === 'scanning' ? 'text-end' : 'text-center')%> text-nowrap d-none d-md-table-cell">
		<%if (pool.type?.toLowerCase() === 'pool' && pool.scanStats) {%>
			<%if (pool.scanStats?.state.toLowerCase() === 'finished') {%>
				<%const duration = moment.duration(moment.unix(pool.scanStats.endTime).diff(moment.unix(pool.scanStats.startTime))).humanize()%>
				<%const tip = `Completed ${moment.unix(pool.scanStats.endTime).fromNow()}.<br>Took ${duration} to scan <strong>${prettyBytes(pool.scanStats.toExamine || 0, { binary: true })}</strong>.<br>Repaired <strong>${prettyBytes(pool.scanStats.processed || 0, { binary: true })}</strong>, ${pool.scanStats.errors || 0} errors.`%>
				<%if (pool.scanStats.errors > 0) {%>
					<i class="icon-solid icon-triangle-exclamation icon-fw text-red-300" data-bs-toggle="tooltip" data-bs-original-title="<%=tip%>" data-bs-custom-class="storage-scan-progress"></i>
				<%} else {%>
					<i class="icon-solid icon-circle-check icon-fw text-green-300" data-bs-toggle="tooltip" data-bs-original-title="<%=tip%>" data-bs-custom-class="storage-scan-progress"></i>
				<%}%>
			<%}%>
			<%if (pool.scanStats?.state.toLowerCase() === 'scanning') {%>
				<%const isPaused = (pool.scanStats.scrubPause > 0)%>
				<%const total = prettyBytes(pool.scanStats.toExamine || 0, { binary: true })%>
				<%const scanned = `${prettyBytes(pool.scanStats.examined || 0, { binary: true })} / ${total}`%>
				<%const issued = `${prettyBytes(pool.scanStats.issued || 0, { binary: true })} / ${total}`%>
				<%const tip = (isPaused ? `<strong>Paused</strong> since ${moment.unix(pool.scanStats.scrubPause).fromNow()}.<br>` : ``) + `Started ${moment.unix(pool.scanStats.startTime).fromNow()}.<br>Scanned ${scanned}.<br>Issued ${issued}.<br>Repaired <strong>${prettyBytes(pool.scanStats.processed || 0, { binary: true })}</strong>, ${pool.scanStats.errors || 0} errors.`%>
				<%const progress = (pool.scanStats.toExamine === 0 ? 0 : (pool.scanStats.issued / pool.scanStats.toExamine) * 100)%>
				<small class="fw-light" data-bs-toggle="tooltip" data-bs-original-title="<%=tip%>" data-bs-custom-class="storage-scan-progress"><%=progress.toFixed(2)%>%</small>
				<div class="progress shadow-none" role="progressbar" style="height: 6px;">
					<div class="progress-bar bg-cyan-300 <%=(!isPaused ? 'progress-bar-striped progress-bar-animated' : '')%>" style="width: <%=(progress)%>%;"></div>
				</div>
			<%}%>
		<%} else {%>
			&mdash;
		<%}%>
	</td>
	<td>
		<u-badge color="<%=(pool.properties.health.value.toLowerCase() === 'online' ? 'green' : 'red')%>" pill><small><%=pool.properties.health.value%></small></u-badge>
	</td>
	<td>
		<div class="dropdown">
			<span data-bs-toggle="dropdown" class="dropdown-toggle caret-off btn btn-sm">
				<i class="icon-solid icon-ellipsis-vertical icon-fw text-secondary"></i>
			</span>
			<ul class="dropdown-menu">
				<li><button type="button" class="dropdown-item disabled">No actions</button></li>
			</ul>
		</div>
	</td>
</tr>

<!--
<div class="col col-xl-4 col-lg-6 col-md-6 col-sm-12 col-12 item d-none">
	<div class="pool card rounded-4 border-0 h-100 mb-0">
		<%if (pool.type?.toLowerCase() === 'pool' && pool.scanStats) {%>
			<div class="card-footer d-flex bg-gray-100 rounded-4 text-body-secondary px-5 py-1">
				<dl class="m-0">
					<%if (pool.scanStats?.state.toLowerCase() !== 'finished') {%>
						<%const progress = (pool.scanStats.toExamine === 0 ? 0 : (pool.scanStats.issued / pool.scanStats.toExamine) * 100)%>
						<dt class="fw-lighter">
							<small>
								<%if (pool.scanStats.scrubPause === 0) {%>
									Running data integrity check...
								<%} else if (pool.scanStats.scrubPause !== 0) {%>
									Data integrity check paused
								<%}%>
							</small>
						</dt>
						<%if (pool.scanStats.status === 'paused') {%>
							<dd class="d-flex align-items-center m-0"><%=_.upperFirst(pool.scan)%></dd>
						<%}%>
						<div class="row g-0 d-flex align-items-baseline">
							<div class="col">
								<div class="progress" role="progressbar">
									<div class="progress-bar bg-cyan-300 <%=(pool.scanStats.scrubPause === 0 ? 'progress-bar-striped progress-bar-animated' : '')%>" style="width: <%=(progress)%>%;"></div>
								</div>
							</div>
							<div class="col-auto lh-1 text-body-tertiary text-end" style="width: 45px;">
								<small class="fw-light"><%=progress?.toFixed(0)%>%</small>
							</div>
						</div>
					<%}%>
				</dl>
			</div>
		<%}%>
	</div>
</div>
-->
